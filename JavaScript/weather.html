<html>
    <head>
        <title>
            Temperaturen 2015 - de Bilt
        </title>
        <style>
            canvas {
                position: absolute;
                left: 0px;
                top: 0px;
            }
        </style>
        <style>
            crosshairCanvas {
                position: absolute;
                left: 0px;
                top: 0px;
            }
        </style>
    </head>
    <body bgcolor="#E6E6FA">
		<canvas id="mycanvas" width="1500" height="1500" position="absolute" left="0px" top="0px"></canvas>
		<canvas id="crosshair" width="1500" height="1500" position="absolute" left="0px" top="0px"></canvas>
		<script type='text/javascript'>
			
			function createTransform(domain, range){
	
				var alpha = (range[1] - range[0]) / (domain[1] - domain[0]);
				var beta = range[1] - alpha * domain[1];
				
				return function(x){
					return alpha * x + beta;
				};
			}		
			
			function drawgraph(){
			     // initiate canvas
				var canvas = document.getElementById('mycanvas');
				var ctx = canvas.getContext('2d');
				
				// initiate graph size
				var graphWidth = 1300
				var graphHeight = 500
				var labelArea = 25
				var graphStartY = 20
				var graphStartX = 20 + labelArea
				
				
				// draw the outline
				ctx.beginPath();
				ctx.fillStyle = "white";
				ctx.fillRect(0, 0, 2 * graphStartX - labelArea + graphWidth, 2 * graphStartY + graphHeight);
				ctx.stroke();
				ctx.closePath();
				
				// extract the data from this html			
				var mainarray = document.getElementById('rawdata').innerHTML.split("\n");
			    
			    // make appropriate arrays
				var dates = new Array();
				var temperatures = new Array();
				
				// store each element from the first extraction in own array
				for (i = 1; i < mainarray.length; i++) {
					buffer = mainarray[i].split(",");
					dates.push(new Date(buffer[0]));
					temperatures.push(buffer[1] / 10); 
				}
				
				var minTemp = Math.min.apply(Math, temperatures);
				var maxTemp = Math.max.apply(Math, temperatures);
				
				// transform min temp to 0 pixels and max temp to graphheight pixels
				var transformtemp = createTransform([minTemp, maxTemp], [0, graphHeight]);
				
				// make first date on 0 pixels and last date on width pixels
				var transformdate = createTransform([0, dates.length], [0, graphWidth]);
				
				
				// start drawing of the gridlines and x labels
				ctx.beginPath();
				
				// format the gridlines and labels
				ctx.strokeStyle = "grey";
				ctx.lineWidth = 1;
				ctx.fillStyle = "black";
				
				// calculate the location for each gridline
				var gridlines = [];
				var interval = 5
				for (i = Math.round(minTemp); i < maxTemp; i++){
    				if (i % interval == 0){
    				    gridlines.push(i);
    				}
				}
    			
    			// draw each gridline
    			for (i = 0; i < gridlines.length; i++){
    			    ctx.moveTo(graphStartX, graphHeight - transformtemp(gridlines[i]));
    			    ctx.lineTo(graphStartX + graphWidth, graphHeight - transformtemp(gridlines[i]));
    			    ctx.stroke();
    			    ctx.fillText(gridlines[i] + "*C", graphStartX - labelArea, graphHeight - transformtemp(gridlines[i]));
    			}
    				
				// end drawing of the gridlines
				ctx.closePath();
				
				
				// draw proper x axis
				ctx.beginPath();
				var zeroY = transformtemp(0);
				
				// format the x axis
				ctx.strokeStyle = "black";
				ctx.lineWidth = 3;
				
				// actual drawing
	            ctx.moveTo(graphStartX, graphHeight - zeroY);				
				ctx.lineTo(graphStartX + graphWidth, graphHeight - zeroY);
				ctx.stroke();
				
				// end drawing of x axis
				ctx.closePath();
				
				
				// begin drawing of the line
				ctx.beginPath();
				
				// graph line formatting
				ctx.strokeStyle = "red";
				ctx.lineWidth = 2;
				
				// draw the line
				for (i = 0; i < temperatures.length; i++) {
				    
				    // for each date move 1 step...
					ctx.lineTo(transformdate(i) + graphStartX, 
					
					// and go the y value (with attention to inversed origin)
					graphHeight + graphStartY - transformtemp(temperatures[i]));
				}
				
				// make the line actually appear?
				ctx.stroke();
				
				// end drawing of the line
				ctx.closePath();

/*
Sorry dat het zo onaf is maar al mijn tijd is opgegaan aan dat de tweede canvas
niet over het eerste heen lag maar ergens onderin de pagina terecht kwam. Ik heb
hierdoor niet doorgehad wat er gebeurde want er leek niks getekend te worden.
Nu is mijn tijd op en is het niet af en daarover baal ik als een stekker.
*/

			     // make the crosshair
    			var crosshairCanvas = document.getElementById("crosshair");
    			var cross = crosshairCanvas.getContext('2d');
    		     
    			// get the location
    			crosshairCanvas.addEventListener("mousemove", function(e){
    			    var posX = e.clientX;
                    var posY = e.clientY;
                    
                    var left = crosshairCanvas.getBoundingClientRect().left;
                    var right = crosshairCanvas.getBoundingClientRect().right;
                    var bottom = crosshairCanvas.getBoundingClientRect().bottom;
                    var top = crosshairCanvas.getBoundingClientRect().top;
                    
                    // clear het scherm (lijkt niks te kunnen wat ik ook doe)
                    cross.strokeRect(left, top, right - left, bottom - top);
                    
                    // draw the vertical crosshair lines
                    cross.beginPath();
                    if (posY > graphHeight - zeroY) {
                        cross.moveTo(posX, graphHeight - zeroY);
                        cross.lineTo(posX, bottom);
                    }
                    else {
                        cross.moveTo(posX, graphHeight - zeroY);
                        cross.lineTo(posX, top);
                    }
                    
                    cross.stroke();
                    cross.closePath();
    			});
			}
			
			
		</script>
       <textarea id="rawdata" visibility: hidden>
                #date,maxtemp
                2015/01/01,   30
                2015/01/02,   73
                2015/01/03,   38
                2015/01/04,   39
                2015/01/05,   24
                2015/01/06,   28
                2015/01/07,   45
                2015/01/08,   65
                2015/01/09,   99
                2015/01/10,   95
                2015/01/11,   64
                2015/01/12,   84
                2015/01/13,   86
                2015/01/14,   44
                2015/01/15,   79
                2015/01/16,   55
                2015/01/17,   30
                2015/01/18,   22
                2015/01/19,   10
                2015/01/20,    8
                2015/01/21,   -5
                2015/01/22,  -12
                2015/01/23,  -28
                2015/01/24,   22
                2015/01/25,   37
                2015/01/26,   59
                2015/01/27,   51
                2015/01/28,   53
                2015/01/29,   24
                2015/01/30,   17
                2015/01/31,   10
                2015/02/01,   26
                2015/02/02,   20
                2015/02/03,   17
                2015/02/04,    2
                2015/02/05,   -7
                2015/02/06,   -2
                2015/02/07,   15
                2015/02/08,   50
                2015/02/09,   57
                2015/02/10,   57
                2015/02/11,   42
                2015/02/12,   26
                2015/02/13,   46
                2015/02/14,   66
                2015/02/15,   26
                2015/02/16,    9
                2015/02/17,   33
                2015/02/18,   18
                2015/02/19,   35
                2015/02/20,   53
                2015/02/21,   32
                2015/02/22,   32
                2015/02/23,   59
                2015/02/24,   54
                2015/02/25,   48
                2015/02/26,   63
                2015/02/27,   49
                2015/02/28,   51
                2015/03/01,   83
                2015/03/02,   53
                2015/03/03,   44
                2015/03/04,   51
                2015/03/05,   57
                2015/03/06,   66
                2015/03/07,   84
                2015/03/08,   93
                2015/03/09,   88
                2015/03/10,   76
                2015/03/11,   27
                2015/03/12,   54
                2015/03/13,   46
                2015/03/14,   34
                2015/03/15,   56
                2015/03/16,   63
                2015/03/17,   76
                2015/03/18,   56
                2015/03/19,   68
                2015/03/20,   49
                2015/03/21,   64
                2015/03/22,   43
                2015/03/23,   31
                2015/03/24,   57
                2015/03/25,   59
                2015/03/26,   50
                2015/03/27,   57
                2015/03/28,   69
                2015/03/29,   93
                2015/03/30,   72
                2015/03/31,   90
                2015/04/01,   65
                2015/04/02,   63
                2015/04/03,   70
                2015/04/04,   54
                2015/04/05,   53
                2015/04/06,   69
                2015/04/07,   71
                2015/04/08,   86
                2015/04/09,  104
                2015/04/10,  113
                2015/04/11,   90
                2015/04/12,  100
                2015/04/13,   84
                2015/04/14,  119
                2015/04/15,  138
                2015/04/16,   99
                2015/04/17,   85
                2015/04/18,   90
                2015/04/19,   78
                2015/04/20,  109
                2015/04/21,  100
                2015/04/22,   85
                2015/04/23,   94
                2015/04/24,  124
                2015/04/25,  121
                2015/04/26,  106
                2015/04/27,   80
                2015/04/28,   60
                2015/04/29,   89
                2015/04/30,   98
                2015/05/01,   87
                2015/05/02,   97
                2015/05/03,  130
                2015/05/04,  154
                2015/05/05,  154
                2015/05/06,  122
                2015/05/07,  118
                2015/05/08,  142
                2015/05/09,  133
                2015/05/10,  128
                2015/05/11,  176
                2015/05/12,  146
                2015/05/13,  127
                2015/05/14,  112
                2015/05/15,   94
                2015/05/16,  105
                2015/05/17,  119
                2015/05/18,  111
                2015/05/19,  100
                2015/05/20,  105
                2015/05/21,  119
                2015/05/22,  149
                2015/05/23,  124
                2015/05/24,  126
                2015/05/25,  124
                2015/05/26,  118
                2015/05/27,  135
                2015/05/28,  129
                2015/05/29,  111
                2015/05/30,  112
                2015/05/31,  126
                2015/06/01,  127
                2015/06/02,  148
                2015/06/03,  138
                2015/06/04,  156
                2015/06/05,  214
                2015/06/06,  156
                2015/06/07,  139
                2015/06/08,  125
                2015/06/09,  116
                2015/06/10,  154
                2015/06/11,  179
                2015/06/12,  216
                2015/06/13,  175
                2015/06/14,  153
                2015/06/15,  133
                2015/06/16,  114
                2015/06/17,  160
                2015/06/18,  143
                2015/06/19,  127
                2015/06/20,  130
                2015/06/21,  144
                2015/06/22,  127
                2015/06/23,  126
                2015/06/24,  158
                2015/06/25,  182
                2015/06/26,  205
                2015/06/27,  176
                2015/06/28,  173
                2015/06/29,  180
                2015/06/30,  206
                2015/07/01,  260
                2015/07/02,  254
                2015/07/03,  241
                2015/07/04,  256
                2015/07/05,  202
                2015/07/06,  187
                2015/07/07,  198
                2015/07/08,  159
                2015/07/09,  135
                2015/07/10,  165
                2015/07/11,  204
                2015/07/12,  177
                2015/07/13,  174
                2015/07/14,  179
                2015/07/15,  179
                2015/07/16,  196
                2015/07/17,  217
                2015/07/18,  182
                2015/07/19,  162
                2015/07/20,  178
                2015/07/21,  210
                2015/07/22,  195
                2015/07/23,  178
                2015/07/24,  184
                2015/07/25,  149
                2015/07/26,  148
                2015/07/27,  166
                2015/07/28,  152
                2015/07/29,  141
                2015/07/30,  138
                2015/07/31,  133
                2015/08/01,  151
                2015/08/02,  177
                2015/08/03,  215
                2015/08/04,  180
                2015/08/05,  189
                2015/08/06,  205
                2015/08/07,  206
                2015/08/08,  187
                2015/08/09,  186
                2015/08/10,  198
                2015/08/11,  200
                2015/08/12,  195
                2015/08/13,  217
                2015/08/14,  209
                2015/08/15,  184
                2015/08/16,  150
                2015/08/17,  143
                2015/08/18,  146
                2015/08/19,  165
                2015/08/20,  179
                2015/08/21,  197
                2015/08/22,  207
                2015/08/23,  197
                2015/08/24,  179
                2015/08/25,  167
                2015/08/26,  202
                2015/08/27,  157
                2015/08/28,  154
                2015/08/29,  170
                2015/08/30,  200
                2015/08/31,  209
                2015/09/01,  161
                2015/09/02,  132
                2015/09/03,  122
                2015/09/04,  135
                2015/09/05,  132
                2015/09/06,  131
                2015/09/07,  142
                2015/09/08,  139
                2015/09/09,  131
                2015/09/10,  143
                2015/09/11,  143
                2015/09/12,  157
                2015/09/13,  166
                2015/09/14,  145
                2015/09/15,  125
                2015/09/16,  154
                2015/09/17,  144
                2015/09/18,  139
                2015/09/19,  134
                2015/09/20,  135
                2015/09/21,  146
                2015/09/22,  131
                2015/09/23,  132
                2015/09/24,  126
                2015/09/25,  116
                2015/09/26,  104
                2015/09/27,  110
                2015/09/28,  105
                2015/09/29,  117
                2015/09/30,  123
                2015/10/01,  106
                2015/10/02,  103
                2015/10/03,  103
                2015/10/04,  103
                2015/10/05,  131
                2015/10/06,  153
                2015/10/07,  149
                2015/10/08,  124
                2015/10/09,  102
                2015/10/10,  109
                2015/10/11,   65
                2015/10/12,   48
                2015/10/13,   38
                2015/10/14,   51
                2015/10/15,   63
                2015/10/16,   77
                2015/10/17,   81
                2015/10/18,   84
                2015/10/19,  105
                2015/10/20,   95
                2015/10/21,   97
                2015/10/22,  119
                2015/10/23,  114
                2015/10/24,  118
                2015/10/25,   99
                2015/10/26,  105
                2015/10/27,  111
                2015/10/28,  106
                2015/10/29,  107
                2015/10/30,  102
                2015/10/31,   98
                2015/11/01,   77
                2015/11/02,   69
                2015/11/03,   90
                2015/11/04,  122
                2015/11/05,  133
                2015/11/06,  155
                2015/11/07,  164
                2015/11/08,  131
                2015/11/09,  136
                2015/11/10,  145
                2015/11/11,  127
                2015/11/12,  133
                2015/11/13,  114
                2015/11/14,   97
                2015/11/15,  143
                2015/11/16,  125
                2015/11/17,  135
                2015/11/18,  131
                2015/11/19,  112
                2015/11/20,   79
                2015/11/21,   43
                2015/11/22,   26
                2015/11/23,   32
                2015/11/24,   42
                2015/11/25,   54
                2015/11/26,   40
                2015/11/27,   45
                2015/11/28,   67
                2015/11/29,  102
                2015/11/30,   95
                2015/12/01,   97
                2015/12/02,  110
                2015/12/03,   98
                2015/12/04,   94
                2015/12/05,   79
                2015/12/06,  105
                2015/12/07,  105
                2015/12/08,   98
                2015/12/09,   76
                2015/12/10,   59
                2015/12/11,   70
                2015/12/12,   76
                2015/12/13,   68
                2015/12/14,   76
                2015/12/15,   74
                2015/12/16,  114
                2015/12/17,  136
                2015/12/18,  118
                2015/12/19,  122
                2015/12/20,  116
                2015/12/21,  104
                2015/12/22,  130
                2015/12/23,  106
                2015/12/24,   98
                2015/12/25,   96
                2015/12/26,  131
                2015/12/27,  118
                2015/12/28,   89
                2015/12/29,   75
                2015/12/30,   69
                2015/12/31,   78   </textarea>
        <script type='text/javascript'>
            drawgraph();
        </script>
    </body>
</html>